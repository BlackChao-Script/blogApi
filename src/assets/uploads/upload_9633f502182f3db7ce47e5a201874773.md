# 服务器渲染(SSR)和浏览器渲染(CSR)的区别

## 一、什么是渲染?

页面上的数据要发生更新，就是渲染。

这个工作放在服务器进行就是服务器渲染，放在浏览器进行就是浏览器渲染。

服务器端渲染，指的是后台语言通过一些模板引擎生成html。

浏览器渲染，指的是用js去生成html，前端做路由。

## 二、浏览器

### 一、浏览器渲染路线：

1. 请求一个 html。
2. 服务端返回一个 html。
3. 浏览器下载 html 里面的 js/css 文件。
4. 等待 js 文件下载完成。
5. 等待 js 加载并初始化完成。
6. 由 js 代码向后端请求数据（ajax/fetch）。
7. 等待后端数据返回。
8. 客户端从无到完整地，把数据渲染为响应页面。

### 二、什么是浏览器渲染(CSR)?

CSR是Client Side Render简称；页面上的内容是我们加载的js文件渲染出来的，js文件运行在浏览器上面，服务端只返回一个html模板。

## 三、服务端

### 一、服务端渲染路线：

1. 请求一个 html。
2. 服务端请求数据。
3. 服务器初始渲染。
4. 服务端返回已经有正确内容的页面。
5. 客户端请求 js/css 文件。
6. 等待 js 文件下载完成。
7. 等待 js 加载并初始化完成。
8. 客户端把剩下一部分渲染完成。

### 二、什么是服务端渲染(SSR)?

SSR是Server Side Render简称；简单理解是将组件或页面通过服务器生成html字符串，再发送到浏览器，最后将静态标记"混合"为客户端上完全交互的应用程序。

### 三、使用SSR的利弊

#### SSR的优势:

1. 更利于SEO

   > 不同爬虫工作原理类似，只会爬取源码，不会执行网站的任何脚本（Google除外，据说Googlebot可以运行javaScript）。使用了React或者其它MVVM框架之后，页面大多数DOM元素都是在客户端根据js动态生成，可供爬虫抓取分析的内容大大减少(如图一)。另外，浏览器爬虫不会等待我们的数据完成之后再去抓取我们的页面数据。服务端渲染返回给客户端的是已经获取了异步数据并执行JavaScript脚本的最终HTML，网络爬中就可以抓取到完整页面的信息。

2. 更利于首屏渲染

   > 首屏的渲染是node发送过来的html字符串，并不依赖于js文件了，这就会使用户更快的看到页面的内容。尤其是针对大型单页应用，打包后文件体积比较大，普通客户端渲染加载所有所需文件时间较长，首页就会有一个很长的白屏等待时间。

#### SSR的局限:

1. 服务器压力大

   > 本来是通过客服端完成渲染，现在统一到服务端node服务去做。尤其是高并发访问的情况，会大量占用服务端端CPU资源；

2. 开发条件受限

   > 在服务端渲染中，只会执行到componentDidMount之前的生命周期钩子，因此项目引用的第三方的库也不可用其它生命周期钩子，这对引用库的选择产生了很大的限制；

3. 学习成本相对较高

   > 除了对webpack、React要熟悉，还需要掌握node、Koa2等相关技术。相对于客户端渲染，项目构建、部署过程更加复杂。



## 三、时间耗时比较

### 1.数据请求

由服务器请求首屏数据，而不是客户端请求首屏数据，这是“快”的一个主要原因。服务端在内网进行请求，数据响应速度快。客户端在不同网络环境进行数据请求，且外网http请求开销大，导致时间差。下图为服务端渲染的数据请求路线和客户端渲染的数据请求路线图

![](https://www.hualigs.cn/image/6179f8e711d05.jpg)

![](https://www.hualigs.cn/image/6179f90ae6d95.jpg)

### 2.html渲染

服务端渲染时先向后端服务器请求数据，然后生成完整首屏html返回给浏览器；而客户端渲染就是等js代码下载、加载、解析完成后再请求数据渲染，等待的过程页面是什么都没有的，就是用户看到的白屏。就是服务端渲染不需要等待js代码下载完成并请求数据，就可以返回一个已有完整数据的首屏页面。

具体流程可参考下面两张图

![](https://www.hualigs.cn/image/6179fa4a7253a.jpg)

![](https://www.hualigs.cn/image/6179fa190fa85.jpg)

